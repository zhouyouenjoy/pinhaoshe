{% extends 'base.html' %}

{% load static %}
{% load like_extras %}

{% block title %}关注的用户最新相册{% endblock %}

{% block content %}

{% if following_users %}
    <div class="masonry-grid" id="masonry-grid">
        {% include 'photos/following_albums_content.html' %}
    </div>  
    <!-- 加载更多按钮和加载指示器 -->
    <div id="load-more-container" class="text-center my-4">
        {% if albums.has_next %}
            <button id="loadfollowing-more-btn" class="btn btn-primary">加载更多</button>
        {% else %}
            <p class="text-muted">没有更多内容了</p>
        {% endif %}
        <div id="loading-spinner" class="spinner-border text-primary" role="status" style="display: none;">
            <span class="visually-hidden">加载中...</span>
        </div>
    </div>
{% else %}
    <div class="alert alert-info">
        <h4>您还没有关注任何用户</h4>
        <p>关注其他用户以查看他们的最新相册。</p>
        <a href="{% url 'photos:gallery' %}" class="btn btn-primary">去发现用户</a>
    </div>
{% endif %}


<script>
// 定义全局初始化函数，供AJAX导航调用

// 页面加载完成后初始化懒加载
document.addEventListener('DOMContentLoaded', function() {
    initFollowingPage();
    });

    // 如果在AJAX导航中加载，直接调用初始化函数
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initFollowingPage);
    } else {
        // DOM已经加载完成
        initFollowingPage();
    }
</script>
{% endblock %}