{% extends 'base.html' %}

{% block title %}{{ target_user.username }}的相册{% endblock %}

{% block content %}
<div class="container">
    <div class="d-flex align-items-center mb-4">
        {% if target_user.userprofile.avatar %}
            <img src="{{ target_user.userprofile.avatar.url }}" alt="{{ target_user.username }}" class="rounded-circle me-3" style="width: 60px; height: 60px; object-fit: cover;">
        {% else %}
            <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 60px; height: 60px;">
                <span class="text-white" style="font-size: 1.5rem;">{{ target_user.username|first|upper }}</span>
            </div>
        {% endif %}
        <div>
            <h2 class="mb-0">{{ target_user.username }}的相册</h2>
            <p class="text-muted mb-0">{{ albums.count }} 个相册</p>
        </div>
    </div>

    {% if albums %}
        <div class="photo-grid">
            {% for album in albums %}
                {% with first_photo=album.photo_set.first %}
                {% if first_photo %}
                <div class="col-6 p-0 m-0 bg-gray-500">
                    <div class="card h-100 m-0 p-1 shadow-sm hover:shadow-md transition-shadow duration-300">
                        <a href="{% url 'photo_detail' first_photo.pk %}">
                            <img src="{{ first_photo.display_image.url }}" class="card-img-top" alt="{{ album.title }}" style="width: 100%; height: 250px; object-fit: cover;">
                        </a>
                        <div class="card-body p-0 m-0" style="height: auto; min-height: 0; padding: 0; margin: 0; background-color: transparent;">
                            <div class="d-flex align-items-center justify-content-between">
                                <div class="d-flex align-items-center">
                                    <h6 class="card-title mb-0 text-truncate" style="font-size: 1rem; margin: 0; padding: 0;">{{ album.title }}</h6>
                                </div>
                                <div class="d-flex align-items-center">
                                    <i class="far fa-heart text-secondary me-1" style="font-size: 0.8rem;"></i>
                                    <span style="font-size: 0.8rem;">
                                        {% with like_count=first_photo.likes.count %}
                                            {{ like_count }}
                                        {% endwith %}
                                    </span>
                                </div>
                            </div>
                       </div>
                    </div>
                </div>
                {% endif %}
                {% endwith %}
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info text-center">
            <h4>暂无相册</h4>
            <p>该用户还没有上传任何相册。</p>
        </div>
    {% endif %}
</div>
{% endblock %}